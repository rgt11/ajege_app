{"ast":null,"code":"import _regeneratorRuntime from\"D:/mobilecross/Ajege/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/mobilecross/Ajege/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"D:/mobilecross/Ajege/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"D:/mobilecross/Ajege/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{IonAvatar,IonBadge,IonButton,IonButtons,IonCardSubtitle,IonCol,IonContent,IonFooter,IonHeader,IonIcon,IonImg,IonItem,IonItemOption,IonItemOptions,IonItemSliding,IonLabel,IonList,IonNote,IonPage,IonRow,IonTitle,IonToolbar}from\"@ionic/react\";import{cart,checkmarkSharp,chevronBackOutline,trashOutline}from\"ionicons/icons\";import{useEffect,useRef,useState}from\"react\";import{CartStore,removeFromCart}from\"../data/CartStore\";import{ProductStore}from\"../data/ProductStore\";import styles from\"./CartProducts.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CartProducts=function CartProducts(){var cartRef=useRef();var products=ProductStore.useState(function(s){return s.products;});var shopCart=CartStore.useState(function(s){return s.product_ids;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cartProducts=_useState2[0],setCartProducts=_useState2[1];var _useState3=useState(6),_useState4=_slicedToArray(_useState3,2),amountLoaded=_useState4[0],setAmountLoaded=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),total=_useState6[0],setTotal=_useState6[1];useEffect(function(){var getCartProducts=function getCartProducts(){setCartProducts([]);setTotal(0);shopCart.forEach(function(product){var favouriteParts=product.split(\"/\");var categorySlug=favouriteParts[0];var productID=favouriteParts[1];var tempCategory=products.filter(function(p){return p.slug===categorySlug;})[0];var tempProduct=tempCategory.products.filter(function(p){return parseInt(p.id)===parseInt(productID);})[0];var tempCartProduct={category:tempCategory,product:tempProduct};setTotal(function(prevTotal){return prevTotal+parseInt(tempProduct.price.replace(\"£\",\"\"));});setCartProducts(function(prevSearchResults){return[].concat(_toConsumableArray(prevSearchResults),[tempCartProduct]);});});};getCartProducts();},[shopCart]);var fetchMore=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://\tIncrement the amount loaded by 6 for the next iteration\nsetAmountLoaded(function(prevAmount){return prevAmount+6;});e.target.complete();case 2:case\"end\":return _context.stop();}}},_callee);}));return function fetchMore(_x){return _ref.apply(this,arguments);};}();var removeProductFromCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(index){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:removeFromCart(index);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function removeProductFromCart(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(IonPage,{id:\"category-page\",className:styles.categoryPage,children:[/*#__PURE__*/_jsx(IonHeader,{children:/*#__PURE__*/_jsx(IonToolbar,{children:/*#__PURE__*/_jsx(IonTitle,{children:\"Cart\"})})}),/*#__PURE__*/_jsxs(IonContent,{fullscreen:true,children:[/*#__PURE__*/_jsx(IonRow,{className:\"ion-text-center ion-margin-top\",children:/*#__PURE__*/_jsx(IonCol,{size:\"12\",children:/*#__PURE__*/_jsxs(IonNote,{children:[cartProducts&&cartProducts.length,\" \",cartProducts.length>1||cartProducts.length===0?\" products\":\" product\",\" found\"]})})}),/*#__PURE__*/_jsx(IonList,{children:cartProducts&&cartProducts.map(function(product,index){if(index<=amountLoaded){return/*#__PURE__*/_jsxs(IonItemSliding,{className:styles.cartSlider,children:[/*#__PURE__*/_jsxs(IonItem,{lines:\"none\",detail:false,className:styles.cartItem,children:[/*#__PURE__*/_jsx(IonAvatar,{children:/*#__PURE__*/_jsx(IonImg,{src:product.product.image})}),/*#__PURE__*/_jsxs(IonLabel,{className:\"ion-padding-start ion-text-wrap\",children:[/*#__PURE__*/_jsx(\"p\",{children:product.category.name}),/*#__PURE__*/_jsx(\"h4\",{children:product.product.name})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.cartActions,children:/*#__PURE__*/_jsx(IonBadge,{color:\"dark\",children:product.product.price})})]},index),/*#__PURE__*/_jsx(IonItemOptions,{side:\"end\",children:/*#__PURE__*/_jsx(IonItemOption,{color:\"danger\",style:{paddingLeft:\"1rem\",paddingRight:\"1rem\"},onClick:function onClick(){return removeProductFromCart(index);},children:/*#__PURE__*/_jsx(IonIcon,{icon:trashOutline})})})]});}})})]}),/*#__PURE__*/_jsx(IonFooter,{className:styles.cartFooter,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.cartCheckout,children:[/*#__PURE__*/_jsxs(IonCardSubtitle,{children:[\"Rp.\",total.toFixed(0)]}),/*#__PURE__*/_jsxs(IonButton,{color:\"primary\",children:[/*#__PURE__*/_jsx(IonIcon,{icon:checkmarkSharp}),\"\\xA0Accept Payment\"]})]})})]});};export default CartProducts;","map":{"version":3,"sources":["D:/mobilecross/Ajege/src/pages/CartProducts.js"],"names":["IonAvatar","IonBadge","IonButton","IonButtons","IonCardSubtitle","IonCol","IonContent","IonFooter","IonHeader","IonIcon","IonImg","IonItem","IonItemOption","IonItemOptions","IonItemSliding","IonLabel","IonList","IonNote","IonPage","IonRow","IonTitle","IonToolbar","cart","checkmarkSharp","chevronBackOutline","trashOutline","useEffect","useRef","useState","CartStore","removeFromCart","ProductStore","styles","CartProducts","cartRef","products","s","shopCart","product_ids","cartProducts","setCartProducts","amountLoaded","setAmountLoaded","total","setTotal","getCartProducts","forEach","product","favouriteParts","split","categorySlug","productID","tempCategory","filter","p","slug","tempProduct","parseInt","id","tempCartProduct","category","prevTotal","price","replace","prevSearchResults","fetchMore","e","prevAmount","target","complete","removeProductFromCart","index","categoryPage","length","map","cartSlider","cartItem","image","name","cartActions","paddingLeft","paddingRight","cartFooter","cartCheckout","toFixed"],"mappings":"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","sourcesContent":["import { IonAvatar, IonBadge, IonButton, IonButtons, IonCardSubtitle, IonCol, IonContent, IonFooter, IonHeader, IonIcon, IonImg, IonItem, IonItemOption, IonItemOptions, IonItemSliding, IonLabel, IonList, IonNote, IonPage, IonRow, IonTitle, IonToolbar } from \"@ionic/react\";\r\nimport { cart, checkmarkSharp, chevronBackOutline, trashOutline } from \"ionicons/icons\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { CartStore, removeFromCart } from \"../data/CartStore\";\r\nimport { ProductStore } from \"../data/ProductStore\";\r\n\r\nimport styles from \"./CartProducts.module.css\";\r\n\r\nconst CartProducts = () => {\r\n\r\n    const cartRef = useRef();\r\n    const products = ProductStore.useState(s => s.products);\r\n    const shopCart = CartStore.useState(s => s.product_ids);\r\n    const [ cartProducts, setCartProducts ] = useState([]);\r\n    const [ amountLoaded, setAmountLoaded ] = useState(6);\r\n\r\n    const [ total, setTotal ] = useState(0);\r\n\r\n    useEffect(() => {\r\n\r\n        const getCartProducts = () => {\r\n\r\n            setCartProducts([]);\r\n            setTotal(0);\r\n\r\n            shopCart.forEach(product => {\r\n\r\n                var favouriteParts = product.split(\"/\");\r\n                var categorySlug = favouriteParts[0];\r\n                var productID = favouriteParts[1];\r\n                \r\n                const tempCategory = products.filter(p => p.slug === categorySlug)[0];\r\n                const tempProduct = tempCategory.products.filter(p => parseInt(p.id) === parseInt(productID))[0];\r\n\r\n                const tempCartProduct = {\r\n\r\n                    category: tempCategory,\r\n                    product: tempProduct\r\n                };\r\n\r\n                setTotal(prevTotal => prevTotal + parseInt(tempProduct.price.replace(\"£\", \"\")));\r\n                setCartProducts(prevSearchResults => [ ...prevSearchResults, tempCartProduct ]);\r\n            });\r\n        }\r\n\r\n        getCartProducts();\r\n    }, [ shopCart ]);\r\n\r\n    const fetchMore = async (e) => {\r\n\r\n\t\t//\tIncrement the amount loaded by 6 for the next iteration\r\n\t\tsetAmountLoaded(prevAmount => (prevAmount + 6));\r\n\t\te.target.complete();\r\n\t}\r\n\r\n    const removeProductFromCart = async (index) => {\r\n\r\n        removeFromCart(index);\r\n    }\r\n\r\n    return (\r\n\r\n        <IonPage id=\"category-page\" className={ styles.categoryPage }>\r\n            <IonHeader>\r\n\t\t\t\t<IonToolbar>\r\n\t\t\t\t\t<IonTitle>Cart</IonTitle>\r\n\t\t\t\t</IonToolbar>\r\n\t\t\t</IonHeader>\r\n\t\t\t\r\n\t\t\t<IonContent fullscreen>\r\n                    <IonRow className=\"ion-text-center ion-margin-top\">\r\n                        <IonCol size=\"12\">\r\n                            <IonNote>{ cartProducts && cartProducts.length } { (cartProducts.length > 1 || cartProducts.length === 0) ? \" products\" : \" product\" } found</IonNote>\r\n                        </IonCol>\r\n                    </IonRow>\r\n\r\n                    <IonList>\r\n                        { cartProducts && cartProducts.map((product, index) => {\r\n\r\n                            if ((index <= amountLoaded)) {\r\n                                return (\r\n                                <IonItemSliding className={ styles.cartSlider }>\r\n                                    <IonItem key={ index } lines=\"none\" detail={ false } className={ styles.cartItem }>\r\n\r\n                                        <IonAvatar>\r\n                                            <IonImg src={ product.product.image } />\r\n                                        </IonAvatar>\r\n                                        <IonLabel className=\"ion-padding-start ion-text-wrap\">\r\n                                            <p>{ product.category.name }</p>\r\n                                            <h4>{ product.product.name }</h4>\r\n                                        </IonLabel>\r\n\r\n                                        <div className={ styles.cartActions }>\r\n                                            <IonBadge color=\"dark\">{ product.product.price }</IonBadge>\r\n                                        </div>\r\n                                    </IonItem>\r\n\r\n                                    <IonItemOptions side=\"end\">\r\n                                        <IonItemOption color=\"danger\" style={{ paddingLeft: \"1rem\", paddingRight: \"1rem\" }} onClick={ () => removeProductFromCart(index) }>\r\n                                            <IonIcon icon={ trashOutline } />\r\n                                        </IonItemOption>\r\n                                    </IonItemOptions>\r\n                                </IonItemSliding>\r\n                                );\r\n                            }\r\n                        })}\r\n                    </IonList>\r\n            </IonContent>\r\n            <IonFooter className={ styles.cartFooter }>\r\n                <div className={ styles.cartCheckout }>\r\n                    <IonCardSubtitle>Rp.{ total.toFixed(0) }</IonCardSubtitle>\r\n                    <IonButton color=\"primary\">\r\n                        <IonIcon icon={ checkmarkSharp } />&nbsp;Accept Payment\r\n                    </IonButton>\r\n                </div>\r\n            </IonFooter>\r\n        </IonPage>\r\n    );\r\n}\r\nexport default CartProducts;"]},"metadata":{},"sourceType":"module"}